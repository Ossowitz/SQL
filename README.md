# SQL

![img.png](img.png)

## Базы данных

**• Предназначены для долговременного хранения информации.** <br/>
**• Позволяют быстро находить нужные данные, так как обладают встроенными средствами поиска.** <br/>
**• Реляционные базы используют табличную структуру для хранения данных, а для работы с ними используют язык SQL.**

## СУБД

*СУБД - это всего лишь приложение, способное манипулировать данными.*

![img_1.png](img_1.png)

**• Система управления базами данных. Например: MySQL, PostgreSQL, Oracle, MsSQL.** <br/>
**• «Надстройка» над базами данных, организующая работу с БД и добавляющая дополнительную функциональность.** <br/>
**• Каждая СУБД обладает своими отличиями. Например, встроенными типами данных.** <br/>
**• Каждая СУБД снабжена своим процедурным языком программирования.**

## DDL & DML

![img_2.png](img_2.png)

## Создание таблиц

*Пример создания базы данных, схемы и таблицы:*

```postgresql
CREATE DATABASE company_repository;

CREATE SCHEMA company_storage;

CREATE TABLE company
(
    id   INT,
    name VARCHAR(128),
    date DATE
);
```

## Операция INSERT

*Операция INSERT позволяет производить вставку данных в таблицу.*

```postgresql
CREATE TABLE company
(
    id   INT,
    name VARCHAR(128),
    date DATE
);

INSERT INTO company (id, name, date)
VALUES (1, 'Google', '2001-01-01'),
       (2, 'Apple', '2002-10-29'),
       (3, 'Facebook', '1998-09-13');
```

## Constraints в PostgreSQL

**Ограничения позволяют избежать ошибок**

Например, если мы храним обычную цену и цену со скидкой, то мы можем гарантировать, что цена со скидкой будет всегда
меньше обычной:

```postgresql
CREATE TABLE products
(
    product_no       integer,
    name             text,
    price            numeric CHECK (price > 0),
    discounted_price numeric CHECK (discounted_price > 0),
    CHECK (price > discounted_price)
);
```

*Из примера выше видно, что ограничение-проверка может ссылаться на несколько столбцов.*

### Ключевое слово CONSTRAINT

*Это ключевое слово используется для создания именованного ограничения:*

```postgresql
CREATE TABLE products
(
    product_no integer,
    name       text,
    price      numeric
        CONSTRAINT positive_price CHECK (price > 0)
);
```

```postgresql
CREATE TABLE company
(
    id   INT PRIMARY KEY,
    name VARCHAR(128) UNIQUE NOT NULL,
    date DATE CHECK ( date > '2000-01-01' AND date < '2023-05-07' )
);
```

### NOT NULL

*Ограничение NOT NULL в PostgreSQL гарантирует, что столбец не может содержать никаких нулевых значений.*

![img_3.png](img_3.png)

### UNIQUE

*Ограничения уникальности гарантируют, что данные в определённом столбце или группе столбцов уникальны среди всех строк
таблицы.*

![img_4.png](img_4.png)

При добавлении ограничения уникальности будет автоматически создан уникальный индекс B-дерева для столбца или группы
столбцов, перечисленных в ограничении.

### CHECK

*Ограничение-проверка - наиболее общий тип ограничений. В его определении вы можете указать, что значение данного
столбца должно удовлетворять логическому выражению (проверке истинности).*

![img_5.png](img_5.png)

### PRIMARY KEY

*Ограничение первичного ключа означает, что образующий его столбец или группа столбцов может быть уникальным
идентификатором строк в таблице*

**Для этого требуется, чтобы значения были одновременно уникальными и отличными от NULL.**

```postgresql
CREATE TABLE products
(
    product_no INT UNIQUE NOT NULL,
    name       TEXT,
    price      NUMERIC
);
CREATE TABLE products
(
    product_no INT PRIMARY KEY,
    name       TEXT,
    price      NUMERIC
);
```

При добавлении первичного ключа автоматически создаётся уникальный индекс B-дерева для столбца или группы столбцов,
перечисленных в первичном ключе, и данные столбца помечаются как NOT NULL.

## Sequence in PostgreSQL

*В PostgreSQL последовательность - это особый тип объекта базы данный, который генерирует последовательность целых
чисел.*

```postgresql
CREATE TABLE company
(
    id SERIAL
);
```

## Операция SELECT

*Операция SELECT позволяет получить строки из таблицы или представления.*

Пример вывода всех полей таблицы:

```postgresql
SELECT *
FROM company;
```

## Alias в PostgreSQL

Псевдонимы таблиц временно назначают таблицам новые имена во время выполнения запроса.

Пример использования псевдонима:

```postgresql
SELECT id,
       name AS alias_name,
       date
FROM company AS com;
```

## Ключевое слово DISTINCT

*Ключевое слово DISTINCT используется в операции SELECT для удаления повторяющихся строк из набора результатов. Предложение
DISTINCT сохраняет одну строку для каждой группы дубликатов. Ключевое слово DISTINCT может быть применимо к одному или нескольким
столбцам в списке выборки операции SELECT.*

Пример использования DISTINCT:

![img_6.png](img_6.png)